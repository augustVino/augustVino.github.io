(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{662:function(t,n,s){"use strict";s.r(n);var a=s(59),e=Object(a.a)({},(function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"web-notification"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web-notification"}},[t._v("#")]),t._v(" Web Notification")]),t._v(" "),s("p",[s("code",[t._v("Web Notifications")]),t._v(",浏览器的系统提示,提示的信息层级高,不会被任何窗口遮挡,干扰也是可控的,HTML5技术.\n"),s("code",[t._v("Web Notifications API")]),t._v(" 使页面可以发出通知,通知将被显示在页面之外的系统层面上（通常使用操作系统的标准通知机制,但是在不同的平台和浏览器上的表现会有差异）.这个功能使  web 应用可以向用户发送信息,即使应用处于空闲状态.")]),t._v(" "),s("image-image",{attrs:{imgSrc:"/img/javascript2.4-1.jpg",imgAlt:"Web Notifications"}}),t._v(" "),s("h4",{attrs:{id:"代码稍微有点儿乱，主要是自己摸索。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码稍微有点儿乱，主要是自己摸索。"}},[t._v("#")]),t._v(" 代码稍微有点儿乱，主要是自己摸索。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'load'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 首先，我们检查是否具有权限显示通知 // 如果没有，我们就申请权限")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// default 未被询问是否授权，所以通知不会被显示")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// granted 已经询问过用户，并且用户已经授予了显示通知的权限 // denied 已经询问过用户，并且用户已经授予了显示通知的权限")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Notification "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" Notification"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"granted"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tNotification"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestPermission")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Notification"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\tNotification"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" button "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'button'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\tbutton"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果用户同意接收通知，我们就尝试发送10条通知 ")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Notification "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" Notification"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"granted"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 多条内容时，为避免满屏的通知提示，我们应该只看到内容最后一条通知内容")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" option"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" body"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HI，我的订单确认了吗？确认了吗？'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" icon"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://xxxx/xxxx/pic000.png'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tag"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tag0'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Notification")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Johnny 发了一条信息给你:"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("option"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Notification.onclick 当用户点击通知时被触发 ")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Notification.onshow 当通知显示的时候被触发 ")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Notification.onerror 当通知遇到错误时被触发 ")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Notification.onclose 当用户关闭通知时被触发 ")]),t._v("\n\t\t\tn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t\t\t\tevent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("preventDefault")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// prevent the browser from focusing the Notification's tab ")]),t._v("\n\t\t\t\twindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://www.ctrip.com'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_blank'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//close () 设置通知关闭事件 ")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果用户没有选择是否同意显示通知 ")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注：由于在 Chrome 中不能确定 permission 属性是否有值，因此检查 ")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 该属性值是否为 "default" 是不安全的。 ')]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Notification "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" Notification"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"denied"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t\tNotification"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestPermission")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Notification"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t\t\t\tNotification"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果用户同意 ")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("status "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"granted"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// tag属性, 和html中id的意义一样，唯一标识，打开for循环看看就明白了？ ")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" option"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" body"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HI，我的订单确认了吗？帮我看看。确认了吗？'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" icon"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://xxxx/xxxx/pic000.png'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tag"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tag0'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Notification")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Johnny 发了一条信息给你:"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("option"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 否则改用 alert ")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hi!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果用户拒绝 ")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 改用 alert ")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bye!?"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701832-86944"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"window.addEventListener('load', function () {\n\t// 首先，我们检查是否具有权限显示通知 // 如果没有，我们就申请权限\n\t// default 未被询问是否授权，所以通知不会被显示\n\t// granted 已经询问过用户，并且用户已经授予了显示通知的权限 // denied 已经询问过用户，并且用户已经授予了显示通知的权限\n\n\tif (window.Notification && Notification.permission !== \"granted\") {\n\t\tNotification.requestPermission(function (status) {\n\t\t\tif (Notification.permission !== status) {\n\t\t\t\tNotification.permission = status;\n\t\t\t}\n\t\t});\n\t}\n\tvar button = document.getElementsByTagName('button')[0];\n\n\tbutton.addEventListener('click', function () {\n\t\t// 如果用户同意接收通知，我们就尝试发送10条通知 \n\t\tif (window.Notification && Notification.permission === \"granted\") { //\n\t\t\tfor (var i = 0; i < 9; i++) { // 多条内容时，为避免满屏的通知提示，我们应该只看到内容最后一条通知内容\n\n\t\t\tvar option={ body: 'HI，我的订单确认了吗？确认了吗？', icon:'http://xxxx/xxxx/pic000.png';, tag: 'tag0' }; \n\t\t\tvar n = new Notification(\"Johnny 发了一条信息给你:\",option);\n\n\t\t\t//Notification.onclick 当用户点击通知时被触发 \n\t\t\t//Notification.onshow 当通知显示的时候被触发 \n\t\t\t//Notification.onerror 当通知遇到错误时被触发 \n\t\t\t//Notification.onclose 当用户关闭通知时被触发 \n\t\t\tn.onclick = function(event) { \n\t\t\t\tevent.preventDefault(); // prevent the browser from focusing the Notification's tab \n\t\t\t\twindow.open('http://www.ctrip.com';, '_blank');\n\t\t\t\t//close () 设置通知关闭事件 \n\t\t\t\tsetTimeout(n.close.bind(n),1000); \n\t\t\t} //\n\t\t} \n\t}\n\n\t// 如果用户没有选择是否同意显示通知 \n\t// 注：由于在 Chrome 中不能确定 permission 属性是否有值，因此检查 \n\t// 该属性值是否为 \"default\" 是不安全的。 \n\telse if (window.Notification && Notification.permission !== \"denied\") { \n\t\tNotification.requestPermission(function (status) { \n\t\t\tif (Notification.permission !== status) { \n\t\t\t\tNotification.permission = status; \n\t\t\t}\n\n\t\t\t// 如果用户同意 \n\t\t\tif (status === \"granted\") { //\n\t\t\t\tfor (var i = 0; i < 10; i++) { \n\t\t\t\t\t// tag属性, 和html中id的意义一样，唯一标识，打开for循环看看就明白了？ \n\t\t\t\t\tvar option={ body: 'HI，我的订单确认了吗？帮我看看。确认了吗？', icon:'http://xxxx/xxxx/pic000.png', tag: 'tag0' }; \n\t\t\t\t\tvar n = new Notification(\"Johnny 发了一条信息给你:\",option); // \n\t\t\t\t} \n\t\t\t}\n\t\t\t// 否则改用 alert \n\t\t\telse { alert(\"Hi!\"); } \n\t\t}); \n\t}\n\t// 如果用户拒绝 \n\telse { // 改用 alert \n\t\talert(\"bye!?\"); \n\t} \n});\n\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701832-86944","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701832-77973"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"window.addEventListener('load', function () {\n\t// 首先，我们检查是否具有权限显示通知 // 如果没有，我们就申请权限\n\t// default 未被询问是否授权，所以通知不会被显示\n\t// granted 已经询问过用户，并且用户已经授予了显示通知的权限 // denied 已经询问过用户，并且用户已经授予了显示通知的权限\n\n\tif (window.Notification && Notification.permission !== \"granted\") {\n\t\tNotification.requestPermission(function (status) {\n\t\t\tif (Notification.permission !== status) {\n\t\t\t\tNotification.permission = status;\n\t\t\t}\n\t\t});\n\t}\n\tvar button = document.getElementsByTagName('button')[0];\n\n\tbutton.addEventListener('click', function () {\n\t\t// 如果用户同意接收通知，我们就尝试发送10条通知 \n\t\tif (window.Notification && Notification.permission === \"granted\") { //\n\t\t\tfor (var i = 0; i < 9; i++) { // 多条内容时，为避免满屏的通知提示，我们应该只看到内容最后一条通知内容\n\n\t\t\tvar option={ body: 'HI，我的订单确认了吗？确认了吗？', icon:'http://xxxx/xxxx/pic000.png';, tag: 'tag0' }; \n\t\t\tvar n = new Notification(\"Johnny 发了一条信息给你:\",option);\n\n\t\t\t//Notification.onclick 当用户点击通知时被触发 \n\t\t\t//Notification.onshow 当通知显示的时候被触发 \n\t\t\t//Notification.onerror 当通知遇到错误时被触发 \n\t\t\t//Notification.onclose 当用户关闭通知时被触发 \n\t\t\tn.onclick = function(event) { \n\t\t\t\tevent.preventDefault(); // prevent the browser from focusing the Notification's tab \n\t\t\t\twindow.open('http://www.ctrip.com';, '_blank');\n\t\t\t\t//close () 设置通知关闭事件 \n\t\t\t\tsetTimeout(n.close.bind(n),1000); \n\t\t\t} //\n\t\t} \n\t}\n\n\t// 如果用户没有选择是否同意显示通知 \n\t// 注：由于在 Chrome 中不能确定 permission 属性是否有值，因此检查 \n\t// 该属性值是否为 \"default\" 是不安全的。 \n\telse if (window.Notification && Notification.permission !== \"denied\") { \n\t\tNotification.requestPermission(function (status) { \n\t\t\tif (Notification.permission !== status) { \n\t\t\t\tNotification.permission = status; \n\t\t\t}\n\n\t\t\t// 如果用户同意 \n\t\t\tif (status === \"granted\") { //\n\t\t\t\tfor (var i = 0; i < 10; i++) { \n\t\t\t\t\t// tag属性, 和html中id的意义一样，唯一标识，打开for循环看看就明白了？ \n\t\t\t\t\tvar option={ body: 'HI，我的订单确认了吗？帮我看看。确认了吗？', icon:'http://xxxx/xxxx/pic000.png', tag: 'tag0' }; \n\t\t\t\t\tvar n = new Notification(\"Johnny 发了一条信息给你:\",option); // \n\t\t\t\t} \n\t\t\t}\n\t\t\t// 否则改用 alert \n\t\t\telse { alert(\"Hi!\"); } \n\t\t}); \n\t}\n\t// 如果用户拒绝 \n\telse { // 改用 alert \n\t\talert(\"bye!?\"); \n\t} \n});\n\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701832-77973","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("h4",{attrs:{id:"说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[t._v("#")]),t._v(" 说明")]),t._v(" "),s("p",[t._v("1.在浏览器中很多API都是需要用户授权的，涉及用户隐私，比如更为熟悉的"),s("code",[t._v("GeoLocation")]),t._v("，"),s("code",[t._v("Web Notifications")]),t._v("也需要先获取权限才能生效，这是对用户体验的考虑，防止滥用。")]),t._v(" "),s("p",[t._v("2.tag属性，见注视中说明，通常多个信息来的时候，要是都显示那就满屏的框，想象下…不可想象…我们还是避免重复类型信息的过度提示，所以tag就有用了")]),t._v(" "),s("p",[t._v("3.调试的时候，chrome上运行时需要web服务，"),s("code",[t._v("apache")]),t._v("就可以，别的随意；firefox不需要，本地就可以调试别问IE…暂时不支持，要实现，方法也是有的，思路：信息来了>弹个框>跨浏览器通信就好，框也能在最上面，但是失焦后么，再见….麻烦….\n什么场景用什么技术解决什么问题，具体情况具体分析。")]),t._v(" "),s("star-star"),t._v(" "),s("comment-comment"),t._v(" "),s("back-to-top")],1)}),[],!1,null,null,null);n.default=e.exports}}]);