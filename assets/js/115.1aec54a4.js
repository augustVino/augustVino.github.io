(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{671:function(t,n,s){"use strict";s.r(n);var e=s(59),a=Object(e.a)({},(function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"chrome-拓展插件开发实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#chrome-拓展插件开发实践"}},[t._v("#")]),t._v(" Chrome 拓展插件开发实践")]),t._v(" "),s("image-image",{attrs:{imgSrc:"/img/other5.4-1.webp",imgAlt:"other5.4-1"}}),t._v(" "),s("blockquote",[s("p",[t._v("部分知识点参考于"),s("a",{attrs:{href:"https://www.jianshu.com/p/f88174f8fe2c",target:"_blank",rel:"noopener noreferrer"}},[t._v("前辈经验"),s("OutboundLink")],1),t._v("，个人学习及相关demo见"),s("a",{attrs:{href:"https://github.com/augustVino/chrome-extensions",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub链接"),s("OutboundLink")],1),t._v(".")])]),t._v(" "),s("h2",{attrs:{id:"manifest-json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#manifest-json"}},[t._v("#")]),t._v(" "),s("code",[t._v("manifest.json")])]),t._v(" "),s("p",[s("code",[t._v("manifest.json")]),t._v("文件用来配置所有和插件相关的配置，必须放在根目录。其中，"),s("code",[t._v("manifest_version")]),t._v("、"),s("code",[t._v("name")]),t._v("、"),s("code",[t._v("version")]),t._v("3个是必不可少的，"),s("code",[t._v("description")]),t._v("和"),s("code",[t._v("icons")]),t._v("是推荐的。相关配置说明如下：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//必选")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n        指定您的应用包要求的清单文件格式的版本。从 Chrome 18 开始，开发人员应该指定 2\n    */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"manifest_version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//推荐")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n        清单文件-默认语言 指定_locales中的子目录，包含该应用默认字符串。\n        对于含有 _locales 目录的应用来说这一属性是必需的，\n        在没有 _locales 目录的应用中该属性不能存在\n    */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 默认语言")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_locale"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zh_CN"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n        插件描述 这个描述在安装应用之后可以看见\n    */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"简单的Chrome扩展demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*一个或多个代表应用、应用或主题背景的图标*/")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 图标，一般偷懒全部用一个尺寸的也没问题")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"icons"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"16"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"img/icon.png"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"48"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"img/icon.png"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"128"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"img/icon.png"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n        后台网页\n        1.应用通常需要有一个长时间运行的脚本来管理一些任务或状态，而后台网页就是为这一目的而设立。\n        通常情况下，后台页面不需要任何 HTML 标记，这种情况下后台页面可以单独使用 JavaScript文件实现。\n        后台页面将由应用系统生成，包含 scripts 属性中列出的每一个文件。\n\n        2.page：如果您需要在您的后台页面中指定 HTML，您可以改用 page 属性：\n\n        3.persistent：应用和应用通常需要长时间运行的脚本来管理某些任务或状态，这就是事件页面的作用。\n        事件页面只在需要时加载，当事件页面不活动时就会卸载，以便释放内存和其他系统资源。\n        如何得到事件页面 就是设置一个")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"persistent"')]),t._v("键，如果没有设置，你将得到一个普通的后台页面。\n    */\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"background"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2种指定方式，如果指定JS，那么会自动生成一个背景页")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"page"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"background.html"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js/background.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"persistent"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n        选择某一个（或者无）\n        browser_action（浏览器按钮）\n        page_action（页面按钮）\n        browser_action、page_action、app必须三选一\n    */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"browser_action"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_icon"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"img/icon.png"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 图标悬停时的标题，可选")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_title"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"这是一个示例Chrome插件"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果有 popup 的页面, 则用户点击图标就会渲染此 HTML 页面")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_popup"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"popup.html"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果并不是对每个网站页面都需要使用插件, 可以使用 page_action(页面按钮） 而不是 browser_action（浏览器按钮）")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// browser_action 应用更加广泛")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果 page_action 并不应用在当前页面, 会显示灰色")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"page_action"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_icon"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"img/icon.png"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_title"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"我是pageAction"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_popup"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"popup.html"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("*/\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//可选")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"author"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开发者"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"automation"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n        内容脚本:其实就是向你想要的网页中插入一个脚本代码，执行你想要做的事情\n        内容脚本是在网页的上下文中运行的 JavaScript 文件，\n        它们可以通过标准的文档对象模型（DOM）来获取浏览器访问的网页详情，或者作出更改。\n        \n        1.run_at 可选。\n        控制 js 中的 JavaScript 文件何时插入，\n        可以为 ")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_start"')]),t._v("、\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_end"')]),t._v(" 或 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_idle"')]),t._v("，默认为 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_idle"')]),t._v("。 \n\n\n        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v("如果是 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_start"')]),t._v("，这些文件将在 css 中指定的文件之后，但是在所有其他 DOM 构造或脚本运行之前插入。 \n\n        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.2")]),t._v(".如果是 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_end"')]),t._v("，文件将在 DOM 完成之后立即插入，但是在加载子资源（如图像与框架）之前插入。 \n\n        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.3")]),t._v(".如果是 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_idle"')]),t._v("，浏览器将在 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_end"')]),t._v(" 和刚发生 window.onload 事件这两个时刻之间选择合适的时候插入，\n        具体的插入时间取决于文档的复杂程度以及加载文档所花的时间，并且浏览器会尽可能地为加快页面加载速度而优化。 \n        \n        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v("all_frames 可选。\n        控制内容脚本运行在匹配页面的所有框架中还是仅在顶层框架中。 默认为 "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("，意味着仅在顶层框架中运行\n        \n        content_scripts还有一些其他不是很常用的属性\n    */\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"content_scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"matches"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://*/*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://*/*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<all_urls>"')]),t._v(" 表示匹配所有地址\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"matches"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<all_urls>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 多个JS按顺序注入")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"js"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js/jquery-1.8.3.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js/content-script.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// JS的注入可以随便一点，但是CSS的注意就要千万小心了，因为一不小心就可能影响全局样式")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"css"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"css/custom.css"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 代码注入的时间，可选值： ")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_start"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_end"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" or "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_idle"')]),t._v("，最后一个表示页面空闲时，默认document_idle\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"run_at"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_start"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//该匹配所有的页面框架")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"all_frames"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里仅仅是为了演示content-script可以配置多个规则")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"matches"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*://*/*.png"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*://*/*.jpg"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*://*/*.gif"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*://*/*.bmp"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//可以针对不同的规则插入不同的内容")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"js"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js/show-image-content-size.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n        权限申请  \n        扩展或app将使用的一组权限。每个权限是一列已知字符串列表中的一个，\n        如geolocatioin或者一个匹配模式，来指定可以访问的一个或者多个主机。\n        权限可以帮助限定危险，如果你的扩展或者app被攻击。\n        一些权限在安装之前，会告知用户\n    */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"permissions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contextMenus"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 右键菜单")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tabs"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 标签")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bookmarks"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使用chrome.bookmarks模块来创建、组织和管理书签")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"notifications"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通知")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webRequest"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// web请求")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webRequestBlocking"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unlimitedStorage"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//提供了一个无限的HTML5配额来存储客户端数据,如数据库和本地存储文件。没有这个权限,扩展仅限于5 MB的本地存储")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"history"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//历史记录的使用权限  chrome.history ")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"storage"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 插件本地存储")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cookies"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Required if the extension uses the chrome.cookies module.")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://*/*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可以通过executeScript或者insertCSS访问的网站")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://*/*"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可以通过executeScript或者insertCSS访问的网站")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"web_accessible_resources"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"images/*.png"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"style/double-rainbow.css"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script/double-rainbow.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script/main.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"templates/*"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n        如果不是通过 chrome web store 自动更新插件\n\n        我们希望扩展能自动升级，理由和让chrome自动升级一样：修改程序bug和安全漏洞 ，增加新功能，提升性能，改善体验。\n        一个扩展的manifest文件里面必须指定一个")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"update_url"')]),t._v("来执行升级检测。\n\n        扩展可以托管在Chrome Web Store，也可以发布到极速浏览器应用开放平台上。\n        如果托管在Chrome Web Store则update_url应该是：http"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//clients2.google.com/service/update2/crx    ")]),t._v("\n    **/\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"update_url"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://clients2.google.com/service/update2/crx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 插件主页，这个很重要，不要浪费了这个免费广告位")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"homepage_url"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.baidu.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n        开发时为扩展指定的唯一标识值。\n        注意：通常您并不需要直接使用这个值，而是在您的代码中使用相对路径或者chrome.extension.getURL()得到的绝对路径。\n        这个值并不是开发时显式指定的，而是Chrome在安装.crx时辅助生成的。(开发时可以通过上传扩展或者手工打包生成crx文件)。 \n        安装完crx，在Chrome的用户数据目录下的Default/Extensions/<extensionId>/<versionString>/manifest.json文件中，您可以看到这个扩展的key\n    **/")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"key"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commands"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// commands API 用来添加快捷键")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 需要在 background page 上添加监听器绑定 handler")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"toggle-feature-foo"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"suggested_key"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ctrl+Shift+Y"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"mac"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Command+Shift+Y"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Toggle feature foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"global"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当 chrome 没有 focus 时也可以生效的快捷键")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 仅限 Ctrl+Shift+[0..9]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_execute_browser_action"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"suggested_key"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"windows"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ctrl+Shift+Y"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"mac"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Command+Shift+Y"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"chromeos"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ctrl+Shift+U"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"linux"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ctrl+Shift+J"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_execute_page_action"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"suggested_key"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ctrl+Shift+E"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"windows"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Alt+Shift+P"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"mac"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Alt+Shift+P"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ...\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 插件名字简写")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"short_name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Short Name"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 覆盖浏览器默认页面")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"chrome_url_overrides"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 覆盖浏览器默认的新标签页")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"newtab"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"newtab.html"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Chrome40以前的插件配置页写法")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"options_page"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"options.html"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Chrome40以后的插件配置页写法，如果2个都写，新版Chrome只认后面这一个")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"options_ui"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"page"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"options.html"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加一些默认的样式，推荐使用")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"chrome_style"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 向地址栏注册一个关键字以提供搜索建议，只能设置一个关键字")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"omnibox"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"keyword"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"go"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// devtools页面入口，注意只能指向一个HTML文件，不能是JS文件")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"devtools_page"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"devtools.html"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    ......\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//还有很多其他的配置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701044-97661"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n    //必选\n    /*\n        指定您的应用包要求的清单文件格式的版本。从 Chrome 18 开始，开发人员应该指定 2\n    */\n    "manifest_version": 2,\n    "name": "demo",\n    "version": "1.0.0",\n\n    //推荐\n    /*\n        清单文件-默认语言 指定_locales中的子目录，包含该应用默认字符串。\n        对于含有 _locales 目录的应用来说这一属性是必需的，\n        在没有 _locales 目录的应用中该属性不能存在\n    */\n    // 默认语言\n    "default_locale": "zh_CN",\n\n    /*\n        插件描述 这个描述在安装应用之后可以看见\n    */\n    "description": "简单的Chrome扩展demo",\n\n    /*一个或多个代表应用、应用或主题背景的图标*/\n    // 图标，一般偷懒全部用一个尺寸的也没问题\n    "icons":\n    {\n        "16": "img/icon.png",\n        "48": "img/icon.png",\n        "128": "img/icon.png"\n    },\n    \n    /*\n        后台网页\n        1.应用通常需要有一个长时间运行的脚本来管理一些任务或状态，而后台网页就是为这一目的而设立。\n        通常情况下，后台页面不需要任何 HTML 标记，这种情况下后台页面可以单独使用 JavaScript文件实现。\n        后台页面将由应用系统生成，包含 scripts 属性中列出的每一个文件。\n\n        2.page：如果您需要在您的后台页面中指定 HTML，您可以改用 page 属性：\n\n        3.persistent：应用和应用通常需要长时间运行的脚本来管理某些任务或状态，这就是事件页面的作用。\n        事件页面只在需要时加载，当事件页面不活动时就会卸载，以便释放内存和其他系统资源。\n        如何得到事件页面 就是设置一个"persistent"键，如果没有设置，你将得到一个普通的后台页面。\n    */\n    "background":\n    {\n        // 2种指定方式，如果指定JS，那么会自动生成一个背景页\n        "page": "background.html"\n        //"scripts": ["js/background.js"]\n        // "persistent":false\n    },\n\n    /*\n        选择某一个（或者无）\n        browser_action（浏览器按钮）\n        page_action（页面按钮）\n        browser_action、page_action、app必须三选一\n    */\n    "browser_action": \n    {\n        "default_icon": "img/icon.png",\n        // 图标悬停时的标题，可选\n        "default_title": "这是一个示例Chrome插件",\n        // 如果有 popup 的页面, 则用户点击图标就会渲染此 HTML 页面\n        "default_popup": "popup.html"\n    },\n\n    // 如果并不是对每个网站页面都需要使用插件, 可以使用 page_action(页面按钮） 而不是 browser_action（浏览器按钮）\n    // browser_action 应用更加广泛\n    // 如果 page_action 并不应用在当前页面, 会显示灰色\n    /*"page_action":\n    {\n        "default_icon": "img/icon.png",\n        "default_title": "我是pageAction",\n        "default_popup": "popup.html"\n    },*/\n\n    //可选\n    "author":"开发者",\n    "automation":"",\n\n    /*\n        内容脚本:其实就是向你想要的网页中插入一个脚本代码，执行你想要做的事情\n        内容脚本是在网页的上下文中运行的 JavaScript 文件，\n        它们可以通过标准的文档对象模型（DOM）来获取浏览器访问的网页详情，或者作出更改。\n        \n        1.run_at 可选。\n        控制 js 中的 JavaScript 文件何时插入，\n        可以为 "document_start"、\n        "document_end" 或 "document_idle"，默认为 "document_idle"。 \n\n\n        1.1如果是 "document_start"，这些文件将在 css 中指定的文件之后，但是在所有其他 DOM 构造或脚本运行之前插入。 \n\n        1.2.如果是 "document_end"，文件将在 DOM 完成之后立即插入，但是在加载子资源（如图像与框架）之前插入。 \n\n        1.3.如果是 "document_idle"，浏览器将在 "document_end" 和刚发生 window.onload 事件这两个时刻之间选择合适的时候插入，\n        具体的插入时间取决于文档的复杂程度以及加载文档所花的时间，并且浏览器会尽可能地为加快页面加载速度而优化。 \n        \n        2.all_frames 可选。\n        控制内容脚本运行在匹配页面的所有框架中还是仅在顶层框架中。 默认为 false，意味着仅在顶层框架中运行\n        \n        content_scripts还有一些其他不是很常用的属性\n    */\n    "content_scripts": \n    [\n        {\n            //"matches": ["http://*/*", "https://*/*"],\n            // "<all_urls>" 表示匹配所有地址\n            "matches": ["<all_urls>"],\n            // 多个JS按顺序注入\n            "js": ["js/jquery-1.8.3.js", "js/content-script.js"],\n            // JS的注入可以随便一点，但是CSS的注意就要千万小心了，因为一不小心就可能影响全局样式\n            "css": ["css/custom.css"],\n            // 代码注入的时间，可选值： "document_start", "document_end", or "document_idle"，最后一个表示页面空闲时，默认document_idle\n            "run_at": "document_start",\n            //该匹配所有的页面框架\n            "all_frames": true \n        },\n        // 这里仅仅是为了演示content-script可以配置多个规则\n        {\n            "matches": ["*://*/*.png", "*://*/*.jpg", "*://*/*.gif", "*://*/*.bmp"],\n            //可以针对不同的规则插入不同的内容\n            "js": ["js/show-image-content-size.js"]\n        }\n    ],\n\n    /*\n        权限申请  \n        扩展或app将使用的一组权限。每个权限是一列已知字符串列表中的一个，\n        如geolocatioin或者一个匹配模式，来指定可以访问的一个或者多个主机。\n        权限可以帮助限定危险，如果你的扩展或者app被攻击。\n        一些权限在安装之前，会告知用户\n    */\n    "permissions":\n    [\n        "contextMenus", // 右键菜单\n        "tabs", // 标签\n        "bookmarks", //使用chrome.bookmarks模块来创建、组织和管理书签\n        "notifications", // 通知\n        "webRequest", // web请求\n        "webRequestBlocking",\n        "unlimitedStorage", //提供了一个无限的HTML5配额来存储客户端数据,如数据库和本地存储文件。没有这个权限,扩展仅限于5 MB的本地存储\n        "history" //历史记录的使用权限  chrome.history \n        "storage", // 插件本地存储\n        "cookies",//Required if the extension uses the chrome.cookies module.\n        "http://*/*", // 可以通过executeScript或者insertCSS访问的网站\n        "https://*/*" // 可以通过executeScript或者insertCSS访问的网站\n    ],\n\n    // 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的\n    "web_accessible_resources": [\n        "images/*.png",\n        "style/double-rainbow.css",\n        "script/double-rainbow.js",\n        "script/main.js",\n        "templates/*"\n    ],\n\n    /**\n        如果不是通过 chrome web store 自动更新插件\n\n        我们希望扩展能自动升级，理由和让chrome自动升级一样：修改程序bug和安全漏洞 ，增加新功能，提升性能，改善体验。\n        一个扩展的manifest文件里面必须指定一个"update_url"来执行升级检测。\n\n        扩展可以托管在Chrome Web Store，也可以发布到极速浏览器应用开放平台上。\n        如果托管在Chrome Web Store则update_url应该是：http://clients2.google.com/service/update2/crx    \n    **/\n    "update_url": "https://clients2.google.com/service/update2/crx",\n\n    // 插件主页，这个很重要，不要浪费了这个免费广告位\n    "homepage_url": "https://www.baidu.com",\n\n    /**\n        开发时为扩展指定的唯一标识值。\n        注意：通常您并不需要直接使用这个值，而是在您的代码中使用相对路径或者chrome.extension.getURL()得到的绝对路径。\n        这个值并不是开发时显式指定的，而是Chrome在安装.crx时辅助生成的。(开发时可以通过上传扩展或者手工打包生成crx文件)。 \n        安装完crx，在Chrome的用户数据目录下的Default/Extensions/<extensionId>/<versionString>/manifest.json文件中，您可以看到这个扩展的key\n    **/\n    "key": "",\n\n    "commands": {\n        // commands API 用来添加快捷键\n        // 需要在 background page 上添加监听器绑定 handler\n        "toggle-feature-foo": {\n            "suggested_key": {\n                "default": "Ctrl+Shift+Y",\n                "mac": "Command+Shift+Y"\n            },\n            "description": "Toggle feature foo",\n            "global": true\n            // 当 chrome 没有 focus 时也可以生效的快捷键\n            // 仅限 Ctrl+Shift+[0..9]\n        },\n        "_execute_browser_action": {\n            "suggested_key": {\n                "windows": "Ctrl+Shift+Y",\n                "mac": "Command+Shift+Y",\n                "chromeos": "Ctrl+Shift+U",\n                "linux": "Ctrl+Shift+J"\n            }\n        },\n        "_execute_page_action": {\n            "suggested_key": {\n                "default": "Ctrl+Shift+E",\n                "windows": "Alt+Shift+P",\n                "mac": "Alt+Shift+P"\n            }\n        },\n        ...\n    },\n\n    // 插件名字简写\n    "short_name": "Short Name", \n    // 覆盖浏览器默认页面\n    "chrome_url_overrides":\n    {\n        // 覆盖浏览器默认的新标签页\n        "newtab": "newtab.html"\n    },\n    // Chrome40以前的插件配置页写法\n    "options_page": "options.html",\n    // Chrome40以后的插件配置页写法，如果2个都写，新版Chrome只认后面这一个\n    "options_ui":\n    {\n        "page": "options.html",\n        // 添加一些默认的样式，推荐使用\n        "chrome_style": true\n    },\n    // 向地址栏注册一个关键字以提供搜索建议，只能设置一个关键字\n    "omnibox": { "keyword" : "go" },\n    \n    // devtools页面入口，注意只能指向一个HTML文件，不能是JS文件\n    "devtools_page": "devtools.html",\n\n    ......\n    //还有很多其他的配置\n}\n',"data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701044-97661","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701044-2142"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n    //必选\n    /*\n        指定您的应用包要求的清单文件格式的版本。从 Chrome 18 开始，开发人员应该指定 2\n    */\n    "manifest_version": 2,\n    "name": "demo",\n    "version": "1.0.0",\n\n    //推荐\n    /*\n        清单文件-默认语言 指定_locales中的子目录，包含该应用默认字符串。\n        对于含有 _locales 目录的应用来说这一属性是必需的，\n        在没有 _locales 目录的应用中该属性不能存在\n    */\n    // 默认语言\n    "default_locale": "zh_CN",\n\n    /*\n        插件描述 这个描述在安装应用之后可以看见\n    */\n    "description": "简单的Chrome扩展demo",\n\n    /*一个或多个代表应用、应用或主题背景的图标*/\n    // 图标，一般偷懒全部用一个尺寸的也没问题\n    "icons":\n    {\n        "16": "img/icon.png",\n        "48": "img/icon.png",\n        "128": "img/icon.png"\n    },\n    \n    /*\n        后台网页\n        1.应用通常需要有一个长时间运行的脚本来管理一些任务或状态，而后台网页就是为这一目的而设立。\n        通常情况下，后台页面不需要任何 HTML 标记，这种情况下后台页面可以单独使用 JavaScript文件实现。\n        后台页面将由应用系统生成，包含 scripts 属性中列出的每一个文件。\n\n        2.page：如果您需要在您的后台页面中指定 HTML，您可以改用 page 属性：\n\n        3.persistent：应用和应用通常需要长时间运行的脚本来管理某些任务或状态，这就是事件页面的作用。\n        事件页面只在需要时加载，当事件页面不活动时就会卸载，以便释放内存和其他系统资源。\n        如何得到事件页面 就是设置一个"persistent"键，如果没有设置，你将得到一个普通的后台页面。\n    */\n    "background":\n    {\n        // 2种指定方式，如果指定JS，那么会自动生成一个背景页\n        "page": "background.html"\n        //"scripts": ["js/background.js"]\n        // "persistent":false\n    },\n\n    /*\n        选择某一个（或者无）\n        browser_action（浏览器按钮）\n        page_action（页面按钮）\n        browser_action、page_action、app必须三选一\n    */\n    "browser_action": \n    {\n        "default_icon": "img/icon.png",\n        // 图标悬停时的标题，可选\n        "default_title": "这是一个示例Chrome插件",\n        // 如果有 popup 的页面, 则用户点击图标就会渲染此 HTML 页面\n        "default_popup": "popup.html"\n    },\n\n    // 如果并不是对每个网站页面都需要使用插件, 可以使用 page_action(页面按钮） 而不是 browser_action（浏览器按钮）\n    // browser_action 应用更加广泛\n    // 如果 page_action 并不应用在当前页面, 会显示灰色\n    /*"page_action":\n    {\n        "default_icon": "img/icon.png",\n        "default_title": "我是pageAction",\n        "default_popup": "popup.html"\n    },*/\n\n    //可选\n    "author":"开发者",\n    "automation":"",\n\n    /*\n        内容脚本:其实就是向你想要的网页中插入一个脚本代码，执行你想要做的事情\n        内容脚本是在网页的上下文中运行的 JavaScript 文件，\n        它们可以通过标准的文档对象模型（DOM）来获取浏览器访问的网页详情，或者作出更改。\n        \n        1.run_at 可选。\n        控制 js 中的 JavaScript 文件何时插入，\n        可以为 "document_start"、\n        "document_end" 或 "document_idle"，默认为 "document_idle"。 \n\n\n        1.1如果是 "document_start"，这些文件将在 css 中指定的文件之后，但是在所有其他 DOM 构造或脚本运行之前插入。 \n\n        1.2.如果是 "document_end"，文件将在 DOM 完成之后立即插入，但是在加载子资源（如图像与框架）之前插入。 \n\n        1.3.如果是 "document_idle"，浏览器将在 "document_end" 和刚发生 window.onload 事件这两个时刻之间选择合适的时候插入，\n        具体的插入时间取决于文档的复杂程度以及加载文档所花的时间，并且浏览器会尽可能地为加快页面加载速度而优化。 \n        \n        2.all_frames 可选。\n        控制内容脚本运行在匹配页面的所有框架中还是仅在顶层框架中。 默认为 false，意味着仅在顶层框架中运行\n        \n        content_scripts还有一些其他不是很常用的属性\n    */\n    "content_scripts": \n    [\n        {\n            //"matches": ["http://*/*", "https://*/*"],\n            // "<all_urls>" 表示匹配所有地址\n            "matches": ["<all_urls>"],\n            // 多个JS按顺序注入\n            "js": ["js/jquery-1.8.3.js", "js/content-script.js"],\n            // JS的注入可以随便一点，但是CSS的注意就要千万小心了，因为一不小心就可能影响全局样式\n            "css": ["css/custom.css"],\n            // 代码注入的时间，可选值： "document_start", "document_end", or "document_idle"，最后一个表示页面空闲时，默认document_idle\n            "run_at": "document_start",\n            //该匹配所有的页面框架\n            "all_frames": true \n        },\n        // 这里仅仅是为了演示content-script可以配置多个规则\n        {\n            "matches": ["*://*/*.png", "*://*/*.jpg", "*://*/*.gif", "*://*/*.bmp"],\n            //可以针对不同的规则插入不同的内容\n            "js": ["js/show-image-content-size.js"]\n        }\n    ],\n\n    /*\n        权限申请  \n        扩展或app将使用的一组权限。每个权限是一列已知字符串列表中的一个，\n        如geolocatioin或者一个匹配模式，来指定可以访问的一个或者多个主机。\n        权限可以帮助限定危险，如果你的扩展或者app被攻击。\n        一些权限在安装之前，会告知用户\n    */\n    "permissions":\n    [\n        "contextMenus", // 右键菜单\n        "tabs", // 标签\n        "bookmarks", //使用chrome.bookmarks模块来创建、组织和管理书签\n        "notifications", // 通知\n        "webRequest", // web请求\n        "webRequestBlocking",\n        "unlimitedStorage", //提供了一个无限的HTML5配额来存储客户端数据,如数据库和本地存储文件。没有这个权限,扩展仅限于5 MB的本地存储\n        "history" //历史记录的使用权限  chrome.history \n        "storage", // 插件本地存储\n        "cookies",//Required if the extension uses the chrome.cookies module.\n        "http://*/*", // 可以通过executeScript或者insertCSS访问的网站\n        "https://*/*" // 可以通过executeScript或者insertCSS访问的网站\n    ],\n\n    // 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的\n    "web_accessible_resources": [\n        "images/*.png",\n        "style/double-rainbow.css",\n        "script/double-rainbow.js",\n        "script/main.js",\n        "templates/*"\n    ],\n\n    /**\n        如果不是通过 chrome web store 自动更新插件\n\n        我们希望扩展能自动升级，理由和让chrome自动升级一样：修改程序bug和安全漏洞 ，增加新功能，提升性能，改善体验。\n        一个扩展的manifest文件里面必须指定一个"update_url"来执行升级检测。\n\n        扩展可以托管在Chrome Web Store，也可以发布到极速浏览器应用开放平台上。\n        如果托管在Chrome Web Store则update_url应该是：http://clients2.google.com/service/update2/crx    \n    **/\n    "update_url": "https://clients2.google.com/service/update2/crx",\n\n    // 插件主页，这个很重要，不要浪费了这个免费广告位\n    "homepage_url": "https://www.baidu.com",\n\n    /**\n        开发时为扩展指定的唯一标识值。\n        注意：通常您并不需要直接使用这个值，而是在您的代码中使用相对路径或者chrome.extension.getURL()得到的绝对路径。\n        这个值并不是开发时显式指定的，而是Chrome在安装.crx时辅助生成的。(开发时可以通过上传扩展或者手工打包生成crx文件)。 \n        安装完crx，在Chrome的用户数据目录下的Default/Extensions/<extensionId>/<versionString>/manifest.json文件中，您可以看到这个扩展的key\n    **/\n    "key": "",\n\n    "commands": {\n        // commands API 用来添加快捷键\n        // 需要在 background page 上添加监听器绑定 handler\n        "toggle-feature-foo": {\n            "suggested_key": {\n                "default": "Ctrl+Shift+Y",\n                "mac": "Command+Shift+Y"\n            },\n            "description": "Toggle feature foo",\n            "global": true\n            // 当 chrome 没有 focus 时也可以生效的快捷键\n            // 仅限 Ctrl+Shift+[0..9]\n        },\n        "_execute_browser_action": {\n            "suggested_key": {\n                "windows": "Ctrl+Shift+Y",\n                "mac": "Command+Shift+Y",\n                "chromeos": "Ctrl+Shift+U",\n                "linux": "Ctrl+Shift+J"\n            }\n        },\n        "_execute_page_action": {\n            "suggested_key": {\n                "default": "Ctrl+Shift+E",\n                "windows": "Alt+Shift+P",\n                "mac": "Alt+Shift+P"\n            }\n        },\n        ...\n    },\n\n    // 插件名字简写\n    "short_name": "Short Name", \n    // 覆盖浏览器默认页面\n    "chrome_url_overrides":\n    {\n        // 覆盖浏览器默认的新标签页\n        "newtab": "newtab.html"\n    },\n    // Chrome40以前的插件配置页写法\n    "options_page": "options.html",\n    // Chrome40以后的插件配置页写法，如果2个都写，新版Chrome只认后面这一个\n    "options_ui":\n    {\n        "page": "options.html",\n        // 添加一些默认的样式，推荐使用\n        "chrome_style": true\n    },\n    // 向地址栏注册一个关键字以提供搜索建议，只能设置一个关键字\n    "omnibox": { "keyword" : "go" },\n    \n    // devtools页面入口，注意只能指向一个HTML文件，不能是JS文件\n    "devtools_page": "devtools.html",\n\n    ......\n    //还有很多其他的配置\n}\n',"data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701044-2142","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("h3",{attrs:{id:"content-scripts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#content-scripts"}},[t._v("#")]),t._v(" "),s("code",[t._v("content-scripts")])]),t._v(" "),s("p",[s("code",[t._v("content-scripts")]),t._v("，其实就是Chrome插件中向页面注入脚本的一种形式（虽然名为script，其实还可以包括"),s("code",[t._v("css")]),t._v("的），借助"),s("code",[t._v("content-scripts")]),t._v("我们可以实现通过配置的方式轻松向指定页面注入"),s("code",[t._v("JS")]),t._v("和"),s("code",[t._v("CSS")]),t._v("，最常见的比如：广告屏蔽、页面"),s("code",[t._v("CSS")]),t._v("定制，等等。")]),t._v(" "),s("p",[s("code",[t._v("content-scripts")]),t._v("和原始页面共享DOM，但是不共享JS，如要访问页面JS（例如某个JS变量），只能通过"),s("code",[t._v("injected js")]),t._v("来实现。"),s("strong",[s("code",[t._v("content-scripts")]),t._v("不能访问绝大部分chrome.xxx.api，除了下面这4种：")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("chrome.extension(getURL , inIncognitoContext , lastError , onRequest , sendRequest)")])]),t._v(" "),s("li",[s("code",[t._v("chrome.i18n")])]),t._v(" "),s("li",[s("code",[t._v("chrome.runtime(connect , getManifest , getURL , id , onConnect , onMessage , sendMessage)")])]),t._v(" "),s("li",[s("code",[t._v("chrome.storage")])])]),t._v(" "),s("p",[t._v("这些API绝大部分时候都够用了，非要调用其它API的话，你还可以通过通信来实现让background来帮你调用。")]),t._v(" "),s("h3",{attrs:{id:"background"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[t._v("#")]),t._v(" "),s("code",[t._v("background")])]),t._v(" "),s("p",[t._v("后台页面，这是一个"),s("strong",[t._v("常驻")]),t._v("的页面，它的生命周期是插件中所有类型页面中"),s("strong",[t._v("最长")]),t._v("的，它随着浏览器的打开而打开，随着浏览器的关闭而关闭，所以通常把需要一直运行的、启动就运行的、全局的代码放在"),s("code",[t._v("background")]),t._v("里面。")]),t._v(" "),s("p",[s("code",[t._v("background")]),t._v("的权限非常高，几乎可以调用所有的Chrome扩展API（"),s("strong",[t._v("除了devtools")]),t._v("），而且它可以无限制跨域，也就是可以跨域访问任何网站而无需要求对方设置"),s("code",[t._v("CORS")]),t._v("。")]),t._v(" "),s("blockquote",[s("p",[t._v("经过测试，其实不止是"),s("code",[t._v("background")]),t._v("，所有的直接通过"),s("code",[t._v("chrome-extension://id/xx.html")]),t._v("这种方式打开的网页都可以无限制跨域。")])]),t._v(" "),s("p",[t._v("配置中，"),s("code",[t._v("background")]),t._v("可以通过"),s("code",[t._v("page")]),t._v("指定一张网页，也可以通过"),s("code",[t._v("scripts")]),t._v("直接指定一个JS，Chrome会自动为这个JS生成一个默认的网页：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 会一直常驻的后台JS或后台页面")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"background"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2种指定方式，如果指定JS，那么会自动生成一个背景页")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"page"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"background.html"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js/background.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701047-73699"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n    // 会一直常驻的后台JS或后台页面\n    "background":\n    {\n        // 2种指定方式，如果指定JS，那么会自动生成一个背景页\n        "page": "background.html"\n        //"scripts": ["js/background.js"]\n    },\n}\n',"data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701047-73699","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701047-99158"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n    // 会一直常驻的后台JS或后台页面\n    "background":\n    {\n        // 2种指定方式，如果指定JS，那么会自动生成一个背景页\n        "page": "background.html"\n        //"scripts": ["js/background.js"]\n    },\n}\n',"data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701047-99158","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("h3",{attrs:{id:"event-pages"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-pages"}},[t._v("#")]),t._v(" "),s("code",[t._v("event-pages")])]),t._v(" "),s("p",[t._v("鉴于"),s("code",[t._v("background")]),t._v("生命周期太长，长时间挂载后台可能会影响性能，所以Google又弄一个"),s("code",[t._v("event-pages")]),t._v("，在配置文件上，它与"),s("code",[t._v("background")]),t._v("的唯一区别就是多了一个"),s("code",[t._v("persistent")]),t._v("参数：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"background"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"event-page.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"persistent"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701047-6847"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n    "background":\n    {\n        "scripts": ["event-page.js"],\n        "persistent": false\n    },\n}\n',"data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701047-6847","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701047-41407"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n    "background":\n    {\n        "scripts": ["event-page.js"],\n        "persistent": false\n    },\n}\n',"data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701047-41407","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("p",[t._v("它的生命周期是："),s("strong",[t._v("在被需要时加载，在空闲时被关闭")]),t._v("，什么叫被需要时呢？比如第一次安装、插件更新、有content-script向它发送消息，等等。")]),t._v(" "),s("h3",{attrs:{id:"popup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#popup"}},[t._v("#")]),t._v(" "),s("code",[t._v("popup")])]),t._v(" "),s("p",[s("code",[t._v("popup")]),t._v("是点击"),s("code",[t._v("browser_action")]),t._v("或者"),s("code",[t._v("page_action")]),t._v("图标时打开的一个小窗口网页，焦点离开网页就立即关闭，一般用来做一些临时性的交互。")]),t._v(" "),s("image-image",{attrs:{imgSrc:"/img/other5.4-2.webp",imgAlt:"other5.4-2"}}),t._v(" "),s("p",[s("code",[t._v("popup")]),t._v("可以包含任意你想要的HTML内容，并且会自适应大小。可以通过"),s("code",[t._v("default_popup")]),t._v("字段来指定"),s("code",[t._v("popup")]),t._v("页面，也可以调用"),s("code",[t._v("setPopup()")]),t._v("方法。")]),t._v(" "),s("p",[t._v("需要特别注意的是，由于单击图标打开"),s("code",[t._v("popup")]),t._v("，焦点离开又立即关闭，所以"),s("code",[t._v("popup")]),t._v("页面的生命周期一般很短，需要长时间运行的代码千万不要写在"),s("code",[t._v("popup")]),t._v("里面。")]),t._v(" "),s("blockquote",[s("p",[t._v("在权限上，它和"),s("code",[t._v("background")]),t._v("非常类似，它们之间最大的不同是生命周期的不同，"),s("code",[t._v("popup")]),t._v("中可以直接通过"),s("code",[t._v("chrome.extension.getBackgroundPage()")]),t._v("获取"),s("code",[t._v("background")]),t._v("的"),s("code",[t._v("window")]),t._v("对象。")])]),t._v(" "),s("h3",{attrs:{id:"injected-script"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#injected-script"}},[t._v("#")]),t._v(" "),s("code",[t._v("injected-script")])]),t._v(" "),s("p",[t._v("指的是通过DOM操作的方式向页面注入的一种JS。为什么需要通过这种方式注入JS呢？")]),t._v(" "),s("p",[t._v("这是因为"),s("code",[t._v("content-script")]),t._v("有一个很大的“缺陷”，也就是无法访问页面中的JS，虽然它可以操作DOM，但是DOM却不能调用它，也就是无法在DOM中通过绑定事件的方式调用"),s("code",[t._v("content-script")]),t._v("中的代码（包括直接写"),s("code",[t._v("onclick")]),t._v("和"),s("code",[t._v("addEventListener")]),t._v("2种方式都不行），但是，“在页面上添加一个按钮并调用插件的扩展API”是一个很常见的需求，那该怎么办呢？其实这就是本小节要讲的。")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("content-script")]),t._v("中通过DOM方式向页面注入"),s("code",[t._v("inject-script")]),t._v("代码示例：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 向页面注入JS")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("injectCustomJs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("jsPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    jsPath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jsPath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'js/inject.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" temp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    temp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAttribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/javascript'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获得的地址类似：chrome-extension://ihcokhadfjfchaeagdoclpnjdiokfakg/js/inject.js")]),t._v("\n    temp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extension"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getURL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jsPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    temp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 放在页面不好看，执行完后移除掉")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parentNode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("head"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\nmanifest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"web_accessible_resources"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js/inject.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701047-28589"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// 向页面注入JS\nfunction injectCustomJs(jsPath) {\n    jsPath = jsPath || 'js/inject.js';\n    var temp = document.createElement('script');\n    temp.setAttribute('type', 'text/javascript');\n    // 获得的地址类似：chrome-extension://ihcokhadfjfchaeagdoclpnjdiokfakg/js/inject.js\n    temp.src = chrome.extension.getURL(jsPath);\n    temp.onload = function() {\n        // 放在页面不好看，执行完后移除掉\n        this.parentNode.removeChild(this);\n    };\n    document.head.appendChild(temp);\n}\n\n\nmanifest.json\n{\n    // 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的\n    \"web_accessible_resources\": [\"js/inject.js\"],\n}\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701047-28589","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701047-5327"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// 向页面注入JS\nfunction injectCustomJs(jsPath) {\n    jsPath = jsPath || 'js/inject.js';\n    var temp = document.createElement('script');\n    temp.setAttribute('type', 'text/javascript');\n    // 获得的地址类似：chrome-extension://ihcokhadfjfchaeagdoclpnjdiokfakg/js/inject.js\n    temp.src = chrome.extension.getURL(jsPath);\n    temp.onload = function() {\n        // 放在页面不好看，执行完后移除掉\n        this.parentNode.removeChild(this);\n    };\n    document.head.appendChild(temp);\n}\n\n\nmanifest.json\n{\n    // 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的\n    \"web_accessible_resources\": [\"js/inject.js\"],\n}\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701047-5327","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("h2",{attrs:{id:"五种类型的js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五种类型的js"}},[t._v("#")]),t._v(" 五种类型的JS")]),t._v(" "),s("p",[t._v("Chrome插件的JS主要可以分为这5类："),s("code",[t._v("injected script")]),t._v("、"),s("code",[t._v("content-script")]),t._v("、"),s("code",[t._v("popup js")]),t._v("、"),s("code",[t._v("background js")]),t._v("和"),s("code",[t._v("devtools js")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"权限对比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#权限对比"}},[t._v("#")]),t._v(" 权限对比")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("JS种类")]),t._v(" "),s("th",[t._v("可访问的API")]),t._v(" "),s("th",[t._v("DOM访问情况")]),t._v(" "),s("th",[t._v("JS访问情况")]),t._v(" "),s("th",[t._v("直接跨域")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("injected script")]),t._v(" "),s("td",[t._v("和普通JS无任何差别，不能访问任何扩展API")]),t._v(" "),s("td",[t._v("可以")]),t._v(" "),s("td",[t._v("可以")]),t._v(" "),s("td",[t._v("不可以")])]),t._v(" "),s("tr",[s("td",[t._v("content script")]),t._v(" "),s("td",[t._v("只能访问 extension、runtime等部分API")]),t._v(" "),s("td",[t._v("可以")]),t._v(" "),s("td",[t._v("不可以")]),t._v(" "),s("td",[t._v("不可以")])]),t._v(" "),s("tr",[s("td",[t._v("popup js")]),t._v(" "),s("td",[t._v("可访问绝大部分API，除了devtools系列")]),t._v(" "),s("td",[t._v("不可直接访问")]),t._v(" "),s("td",[t._v("不可以")]),t._v(" "),s("td",[t._v("不可以")])]),t._v(" "),s("tr",[s("td",[t._v("background js")]),t._v(" "),s("td",[t._v("可访问绝大部分API，除了devtools系列")]),t._v(" "),s("td",[t._v("不可直接访问")]),t._v(" "),s("td",[t._v("不可以")]),t._v(" "),s("td",[t._v("不可以")])]),t._v(" "),s("tr",[s("td",[t._v("devtools js")]),t._v(" "),s("td",[t._v("只能访问 devtools、extension、runtime等部分API")]),t._v(" "),s("td",[t._v("可以")]),t._v(" "),s("td",[t._v("可以")]),t._v(" "),s("td",[t._v("不可以")])])])]),t._v(" "),s("h3",{attrs:{id:"消息通信"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消息通信"}},[t._v("#")]),t._v(" 消息通信")]),t._v(" "),s("h4",{attrs:{id:"popup和background"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#popup和background"}},[t._v("#")]),t._v(" popup和background")]),t._v(" "),s("p",[s("code",[t._v("popup")]),t._v("可以直接调用"),s("code",[t._v("background")]),t._v("中的JS方法，也可以直接访问"),s("code",[t._v("background")]),t._v("的DOM：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// background.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'我是background！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// popup.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" bg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extension"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBackgroundPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 访问bg的函数")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 访问bg的DOM")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701047-60193"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// background.js\nfunction test() {\n    alert('我是background！');\n}\n\n// popup.js\nvar bg = chrome.extension.getBackgroundPage();\nbg.test(); // 访问bg的函数\nalert(bg.document.body.innerHTML); // 访问bg的DOM\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701047-60193","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701047-92941"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// background.js\nfunction test() {\n    alert('我是background！');\n}\n\n// popup.js\nvar bg = chrome.extension.getBackgroundPage();\nbg.test(); // 访问bg的函数\nalert(bg.document.body.innerHTML); // 访问bg的DOM\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701047-92941","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("p",[t._v("在bg下面访问"),s("code",[t._v("popup")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" views "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extension"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getViews")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'popup'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701048-7163"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"var views = chrome.extension.getViews({type:'popup'});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701048-7163","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701048-34642"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"var views = chrome.extension.getViews({type:'popup'});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701048-34642","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("h4",{attrs:{id:"popup-或者-content-scripts向主动bg发送消息-已验证）"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#popup-或者-content-scripts向主动bg发送消息-已验证）"}},[t._v("#")]),t._v(" popup 或者 content-scripts向主动bg发送消息(已验证）")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//popup.js /content-scripts")]),t._v("\nchrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runtime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("greeting"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你好，我是content-script呀，我主动发消息给后台！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'收到来自后台的回复：'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701048-13885"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"//popup.js /content-scripts\nchrome.runtime.sendMessage({greeting: '你好，我是content-script呀，我主动发消息给后台！'}, function(response) {\n    console.log('收到来自后台的回复：' + response);\n});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701048-13885","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701048-38109"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"//popup.js /content-scripts\nchrome.runtime.sendMessage({greeting: '你好，我是content-script呀，我主动发消息给后台！'}, function(response) {\n    console.log('收到来自后台的回复：' + response);\n});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701048-38109","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//bg")]),t._v("\nchrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runtime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sender"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sendResponse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'收到来自popup.js的消息：'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sender"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sendResponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendResponse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'我是后台，我已收到你的消息：'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701048-84920"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"//bg\nchrome.runtime.onMessage.addListener(function(request, sender, sendResponse)\n{\n    console.log('收到来自popup.js的消息：');\n    console.log(request, sender, sendResponse);\n    sendResponse('我是后台，我已收到你的消息：' + JSON.stringify(request));\n});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701048-84920","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701048-94779"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"//bg\nchrome.runtime.onMessage.addListener(function(request, sender, sendResponse)\n{\n    console.log('收到来自popup.js的消息：');\n    console.log(request, sender, sendResponse);\n    sendResponse('我是后台，我已收到你的消息：' + JSON.stringify(request));\n});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701048-94779","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("p",[t._v("在互相发送消息的时候我们要注意生命周期的问题，我们肯定是需要先注册监听事件，再注册发送事件才行。不然肯定是无法接收到消息的。")]),t._v(" "),s("p",[t._v("所以"),s("code",[t._v("popup.js")]),t._v("是点击的时候才会执行。因此"),s("code",[t._v("content-scripts")]),t._v("无法直接给"),s("code",[t._v("popup.js")]),t._v("发送消息。而经过验证"),s("code",[t._v("popup.js")]),t._v("貌似也无法直接给"),s("code",[t._v("content-scripts")]),t._v("发送消息，需要通过点击事件。")]),t._v(" "),s("h4",{attrs:{id:"injected-script和content-script"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#injected-script和content-script"}},[t._v("#")]),t._v(" "),s("code",[t._v("injected script")]),t._v("和"),s("code",[t._v("content-script")])]),t._v(" "),s("p",[s("code",[t._v("content-script")]),t._v("和页面内的脚本（"),s("code",[t._v("injected-script")]),t._v("自然也属于页面内的脚本）之间唯一共享的东西就是页面的DOM元素，有2种方法可以实现二者通讯：")]),t._v(" "),s("p",[s("strong",[t._v("可以通过"),s("code",[t._v("window.postMessage")]),t._v("和"),s("code",[t._v("window.addEventListener")]),t._v("来实现二者消息通讯；")])]),t._v(" "),s("ol",[s("li",[t._v("第一种（推荐）")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// injected-script中：")]),t._v("\nwindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你好！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// content script中：")]),t._v("\nwindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701048-97138"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// injected-script中：\nwindow.postMessage({\"test\": '你好！'}, '*');\n\n\n// content script中：\nwindow.addEventListener(\"message\", function(e) {\n    console.log(e.data);\n}, false);\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701048-97138","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701048-375"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// injected-script中：\nwindow.postMessage({\"test\": '你好！'}, '*');\n\n\n// content script中：\nwindow.addEventListener(\"message\", function(e) {\n    console.log(e.data);\n}, false);\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701048-375","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("第二种：")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// injected-script中：")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" customEvent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createEvent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Event'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncustomEvent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initEvent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myCustomEvent'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fireCustomEvent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    hiddenDiv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myCustomEventDiv'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    hiddenDiv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerText "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data\n    hiddenDiv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatchEvent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("customEvent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fireCustomEvent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你好，我是普通JS！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// content script中：")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" hiddenDiv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myCustomEventDiv'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("hiddenDiv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    hiddenDiv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    hiddenDiv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("display "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hiddenDiv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nhiddenDiv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myCustomEvent'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" eventData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myCustomEventDiv'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerText"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'收到自定义事件消息：'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" eventData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701049-19515"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// injected-script中：\nvar customEvent = document.createEvent('Event');\ncustomEvent.initEvent('myCustomEvent', true, true);\nfunction fireCustomEvent(data) {\n    hiddenDiv = document.getElementById('myCustomEventDiv');\n    hiddenDiv.innerText = data\n    hiddenDiv.dispatchEvent(customEvent);\n}\nfireCustomEvent('你好，我是普通JS！');\n\n\n// content script中：\nvar hiddenDiv = document.getElementById('myCustomEventDiv');\nif(!hiddenDiv) {\n    hiddenDiv = document.createElement('div');\n    hiddenDiv.style.display = 'none';\n    document.body.appendChild(hiddenDiv);\n}\nhiddenDiv.addEventListener('myCustomEvent', function() {\n    var eventData = document.getElementById('myCustomEventDiv').innerText;\n    console.log('收到自定义事件消息：' + eventData);\n});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701049-19515","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701049-38405"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// injected-script中：\nvar customEvent = document.createEvent('Event');\ncustomEvent.initEvent('myCustomEvent', true, true);\nfunction fireCustomEvent(data) {\n    hiddenDiv = document.getElementById('myCustomEventDiv');\n    hiddenDiv.innerText = data\n    hiddenDiv.dispatchEvent(customEvent);\n}\nfireCustomEvent('你好，我是普通JS！');\n\n\n// content script中：\nvar hiddenDiv = document.getElementById('myCustomEventDiv');\nif(!hiddenDiv) {\n    hiddenDiv = document.createElement('div');\n    hiddenDiv.style.display = 'none';\n    document.body.appendChild(hiddenDiv);\n}\nhiddenDiv.addEventListener('myCustomEvent', function() {\n    var eventData = document.getElementById('myCustomEventDiv').innerText;\n    console.log('收到自定义事件消息：' + eventData);\n});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701049-38405","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("h4",{attrs:{id:"长连接和短连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#长连接和短连接"}},[t._v("#")]),t._v(" 长连接和短连接")]),t._v(" "),s("p",[t._v("其实上面已经涉及到了，这里再单独说明一下。Chrome插件中有2种通信方式，一个是短连接（"),s("code",[t._v("chrome.tabs.sendMessage")]),t._v("和"),s("code",[t._v("chrome.runtime.sendMessage")]),t._v("），一个是长连接（"),s("code",[t._v("chrome.tabs.connect")]),t._v("和"),s("code",[t._v("chrome.runtime.connect")]),t._v("）。\n长短连接的概念我就不说了，大家都应该知道。")]),t._v(" "),s("p",[t._v("短连接上面已经有代码示例了，这里只讲一下长连接。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("popup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取当前选项卡ID")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrentTabId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("callback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tabs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" active"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" currentWindow"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tabs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tabs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" tabs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callbackInfo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tabId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tabId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" port "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tabs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tabId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test-connect'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" question"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你是谁啊？'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'收到消息：'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("answer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("answer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("answer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startsWith")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'我是'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" question"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'哦，原来是你啊！'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n   "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrentTabId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callbackInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701049-57153"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"popup.js\n\n// 获取当前选项卡ID\n   function getCurrentTabId(callback) {\n     chrome.tabs.query({ active: true, currentWindow: true }, function(tabs) {\n       if (callback) callback(tabs.length ? tabs[0].id : null);\n     });\n   }\n\n   function callbackInfo(tabId) {\n     console.log(tabId)\n     var port = chrome.tabs.connect(tabId, { name: 'test-connect' });\n     port.postMessage({ question: '你是谁啊？' });\n     port.onMessage.addListener(function(msg) {\n       alert('收到消息：' + msg.answer);\n       if (msg.answer && msg.answer.startsWith('我是')) {\n         port.postMessage({ question: '哦，原来是你啊！' });\n       }\n     });\n   }\n\n   getCurrentTabId(callbackInfo)\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701049-57153","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701049-50490"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"popup.js\n\n// 获取当前选项卡ID\n   function getCurrentTabId(callback) {\n     chrome.tabs.query({ active: true, currentWindow: true }, function(tabs) {\n       if (callback) callback(tabs.length ? tabs[0].id : null);\n     });\n   }\n\n   function callbackInfo(tabId) {\n     console.log(tabId)\n     var port = chrome.tabs.connect(tabId, { name: 'test-connect' });\n     port.postMessage({ question: '你是谁啊？' });\n     port.onMessage.addListener(function(msg) {\n       alert('收到消息：' + msg.answer);\n       if (msg.answer && msg.answer.startsWith('我是')) {\n         port.postMessage({ question: '哦，原来是你啊！' });\n       }\n     });\n   }\n\n   getCurrentTabId(callbackInfo)\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701049-50490","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//content-script.js： 监听长连接")]),t._v("\nchrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runtime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onConnect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test-connect'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'收到长连接消息：'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("question "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你是谁啊？'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("answer"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'我是司音！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701053-53311"}},[t._v("copy success")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"//content-script.js： 监听长连接\nchrome.runtime.onConnect.addListener(function(port) {\n    console.log(port);\n    if(port.name == 'test-connect') {\n        port.onMessage.addListener(function(msg) {\n            console.log('收到长连接消息：', msg);\n            if(msg.question == '你是谁啊？') port.postMessage({answer: '我是司音！'});\n        });\n    }\n});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701053-53311","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("copy")])]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1589775701053-57167"}},[t._v("Copy successed")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"//content-script.js： 监听长连接\nchrome.runtime.onConnect.addListener(function(port) {\n    console.log(port);\n    if(port.name == 'test-connect') {\n        port.onMessage.addListener(function(msg) {\n            console.log('收到长连接消息：', msg);\n            if(msg.question == '你是谁啊？') port.postMessage({answer: '我是司音！'});\n        });\n    }\n});\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1589775701053-57167","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"Copy failed",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("Copy")])])])]),t._v(" "),s("star-star"),t._v(" "),s("comment-comment"),t._v(" "),s("back-to-top")],1)}),[],!1,null,null,null);n.default=a.exports}}]);